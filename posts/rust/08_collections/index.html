<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Rust - Basic - 08 - Collections | KuthorX Blog II</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="RRRRRRRR"><meta name=generator content="Hugo 0.148.2"><meta name=robots content="index, follow"><link rel=stylesheet href=/ananke/css/main.min.8d048772ae72ab11245a0e296d1f2a36d3e3dd376c6c867394d6cc659c68fc37.css><link rel=stylesheet href=/css/about.css><link rel="shortcut icon" href=/images/KuthorX-512.webp type=image/x-icon><link rel=canonical href=https://kuthorx.github.io/posts/rust/08_collections/><meta property="og:url" content="https://kuthorx.github.io/posts/rust/08_collections/"><meta property="og:site_name" content="KuthorX Blog II"><meta property="og:title" content="Rust - Basic - 08 - Collections"><meta property="og:description" content="RRRRRRRR"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-03T00:00:08+08:00"><meta property="article:modified_time" content="2022-01-03T00:00:08+08:00"><meta itemprop=name content="Rust - Basic - 08 - Collections"><meta itemprop=description content="RRRRRRRR"><meta itemprop=datePublished content="2022-01-03T00:00:08+08:00"><meta itemprop=dateModified content="2022-01-03T00:00:08+08:00"><meta itemprop=wordCount content="535"><meta name=twitter:card content="summary"><meta name=twitter:title content="Rust - Basic - 08 - Collections"><meta name=twitter:description content="RRRRRRRR"></head><body class="ma0 avenir bg-near-white production"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l center items-center justify-between"><a href=/ class="f3 fw2 hover-white white-90 dib no-underline">KuthorX Blog II</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white white-90 no-underline" href=/about/ title="About 页">About</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white white-90 no-underline" href=/posts/ title="Posts 页">Posts</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white white-90 no-underline" href=/repos/ title="Repos 页">Repos</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white white-90 no-underline" href=/story_of_cloak/ title="苍绿之眼-故事线 页">苍绿之眼-故事线</a></li></ul><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l mw8 center ph3 flex-wrap justify-between"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked ttu">Rust</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">Rust - Basic - 08 - Collections</h1><time class="f6 mv4 dib tracked" datetime=2022-01-03T00:00:08+08:00>一月 3, 2022</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h1 id=collections>Collections</h1><h1 id=comprehension>Comprehension</h1><ul><li><p>vector</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#75715e>// 声明方式 1 - 不可变、new、指定类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> v: Vec<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>i32</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> Vec::new();
</span></span><span style=display:flex><span><span style=color:#75715e>// 声明方式 2 - 使用 macro
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> v <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>];
</span></span><span style=display:flex><span><span style=color:#75715e>// 声明方式 3 - 可变、new、后续 push 时自动指定类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> v <span style=color:#f92672>=</span> Vec::new();
</span></span><span style=display:flex><span>v.push(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 获取元素
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> v <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>];
</span></span><span style=display:flex><span><span style=color:#75715e>// 如果越界就 panic
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> third: <span style=color:#66d9ef>&amp;</span><span style=color:#66d9ef>i32</span> <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>v[<span style=color:#ae81ff>2</span>];
</span></span><span style=display:flex><span><span style=color:#a6e22e>println!</span>(<span style=color:#e6db74>&#34;The third element is </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span>, third);
</span></span><span style=display:flex><span><span style=color:#75715e>// 如果越界则可以在 None 分支处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>match</span> v.get(<span style=color:#ae81ff>2</span>) {
</span></span><span style=display:flex><span>    Some(third) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>println!</span>(<span style=color:#e6db74>&#34;The third element is </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span>, third),
</span></span><span style=display:flex><span>    None <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>println!</span>(<span style=color:#e6db74>&#34;There is no third element.&#34;</span>),
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 遍历
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> v <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>57</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#66d9ef>in</span> <span style=color:#f92672>&amp;</span>v {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>println!</span>(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span>, i);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// 可变遍历
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> v <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec!</span>[<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>57</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#66d9ef>in</span> <span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> v {
</span></span><span style=display:flex><span>    <span style=color:#f92672>*</span>i <span style=color:#f92672>+=</span> <span style=color:#ae81ff>50</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 虽然 Vector 只能支持一种类型，但是可以通过 enum 来扩展
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>SpreadsheetCell</span> {
</span></span><span style=display:flex><span>    Int(<span style=color:#66d9ef>i32</span>),
</span></span><span style=display:flex><span>    Float(<span style=color:#66d9ef>f64</span>),
</span></span><span style=display:flex><span>    Text(String),
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> row <span style=color:#f92672>=</span> <span style=color:#a6e22e>vec!</span>[
</span></span><span style=display:flex><span>    SpreadsheetCell::Int(<span style=color:#ae81ff>3</span>),
</span></span><span style=display:flex><span>    SpreadsheetCell::Text(String::from(<span style=color:#e6db74>&#34;blue&#34;</span>)),
</span></span><span style=display:flex><span>    SpreadsheetCell::Float(<span style=color:#ae81ff>10.12</span>),
</span></span><span style=display:flex><span>];
</span></span></code></pre></div></li><li><p>string</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#75715e>// 初始化方式 1 - new
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> s <span style=color:#f92672>=</span> String::new();
</span></span><span style=display:flex><span><span style=color:#75715e>// 初始化方式 2 - to_string
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> data <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;initial contents&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> s <span style=color:#f92672>=</span> data.to_string();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 拼接方式 1 - push_str
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>s.push_str(<span style=color:#e6db74>&#34;bar&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// 拼接方式 2 - push
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>s.push(<span style=color:#e6db74>&#39;l&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// 拼接方式 3 - +
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> s1 <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;Hello, &#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> s2 <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;world!&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> s3 <span style=color:#f92672>=</span> s1 <span style=color:#f92672>+</span> <span style=color:#f92672>&amp;</span>s2;  <span style=color:#75715e>// s1 被 move
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 拼接方式 4 - format!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> s1 <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;tic&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> s2 <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;tac&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> s3 <span style=color:#f92672>=</span> String::from(<span style=color:#e6db74>&#34;toe&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> s <span style=color:#f92672>=</span> <span style=color:#a6e22e>format!</span>(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span>, s1, s2, s3);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// string 在 Rust 里有三种表现形式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#e6db74>&#34;नमस्ते&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Bytes 字节、 Scalar Values 标量值、 Grapheme Clusters 字素。依次表现如下
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>[<span style=color:#ae81ff>224</span>, <span style=color:#ae81ff>164</span>, <span style=color:#ae81ff>168</span>, <span style=color:#ae81ff>224</span>, <span style=color:#ae81ff>164</span>, <span style=color:#ae81ff>174</span>, <span style=color:#ae81ff>224</span>, <span style=color:#ae81ff>164</span>, <span style=color:#ae81ff>184</span>, <span style=color:#ae81ff>224</span>, <span style=color:#ae81ff>165</span>, <span style=color:#ae81ff>141</span>, <span style=color:#ae81ff>224</span>, <span style=color:#ae81ff>164</span>, <span style=color:#ae81ff>164</span>,
</span></span><span style=display:flex><span><span style=color:#ae81ff>224</span>, <span style=color:#ae81ff>165</span>, <span style=color:#ae81ff>135</span>]  <span style=color:#75715e>// for b in &#34;नमस्ते&#34;.bytes()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>[<span style=color:#e6db74>&#39;न&#39;</span>, <span style=color:#e6db74>&#39;म&#39;</span>, <span style=color:#e6db74>&#39;स&#39;</span>, <span style=color:#e6db74>&#39;्&#39;</span>, <span style=color:#e6db74>&#39;त&#39;</span>, <span style=color:#e6db74>&#39;े&#39;</span>]  <span style=color:#75715e>// for b in &#34;नमस्ते&#34;.chars()
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>[<span style=color:#e6db74>&#34;न&#34;</span>, <span style=color:#e6db74>&#34;म&#34;</span>, <span style=color:#e6db74>&#34;स्&#34;</span>, <span style=color:#e6db74>&#34;ते&#34;</span>]  <span style=color:#75715e>// 标准库没有提供可用于 for-in 迭代函数
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 取 string 部分值的时候，无法直接用 index 获取
</span></span></span><span style=display:flex><span><span style=color:#75715e>// let s1 = String::from(&#34;hello&#34;); let h = s1[0];
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 可以用 slice
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> hello <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Здравствуйте&#34;</span>;  <span style=color:#75715e>// 这里每个字素都需要 2 个 Bytes 存储
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> s <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>hello[<span style=color:#ae81ff>0</span><span style=color:#f92672>..</span><span style=color:#ae81ff>4</span>];  <span style=color:#75715e>// 但需要注意 range 范围合法，这里如果是 [0..1] 则会运行时 panic
</span></span></span></code></pre></div></li><li><p>hash map</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#75715e>// 初始化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> scores <span style=color:#f92672>=</span> HashMap::new();
</span></span><span style=display:flex><span><span style=color:#75715e>// 新增/覆盖值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>scores.insert(String::from(<span style=color:#e6db74>&#34;Blue&#34;</span>), <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>scores.insert(String::from(<span style=color:#e6db74>&#34;Yellow&#34;</span>), <span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// 获取值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> score <span style=color:#f92672>=</span> scores.get(<span style=color:#f92672>&amp;</span>color);
</span></span><span style=display:flex><span><span style=color:#75715e>// for-in
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>for</span> (key, value) <span style=color:#66d9ef>in</span> <span style=color:#f92672>&amp;</span>scores {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>println!</span>(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span>, key, value);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// 不存在则新增
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>scores.entry(String::from(<span style=color:#e6db74>&#34;Yellow&#34;</span>)).or_insert(<span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span>scores.entry(String::from(<span style=color:#e6db74>&#34;Blue&#34;</span>)).or_insert(<span style=color:#ae81ff>50</span>);
</span></span></code></pre></div></li></ul><h1 id=origin>Origin</h1><blockquote><p><a href=https://doc.rust-lang.org/std/collections/index.html>https://doc.rust-lang.org/std/collections/index.html</a>
<a href=https://doc.rust-lang.org/book/ch08-00-common-collections.html>https://doc.rust-lang.org/book/ch08-00-common-collections.html</a></p></blockquote><p>&mldr;</p><h3 id=methods-for-iterating-over-strings><a href=https://doc.rust-lang.org/book/ch08-02-strings.html#methods-for-iterating-over-strings>Methods for Iterating Over Strings</a></h3><p>Fortunately, you can access elements in a string in other ways.</p><p>If you need to perform operations on individual Unicode scalar values, the best way to do so is to use the <code>chars</code> method. Calling <code>chars</code> on “नमस्ते” separates out and returns six values of type <code>char</code>, and you can iterate over the result to access each element:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> c <span style=color:#66d9ef>in</span> <span style=color:#e6db74>&#34;नमस्ते&#34;</span>.chars() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>println!</span>(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span>, c);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This code will print the following:</p><pre tabindex=0><code>
न
म
स
्
त
े
</code></pre><p>The <code>bytes</code> method returns each raw byte, which might be appropriate for your domain:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> b <span style=color:#66d9ef>in</span> <span style=color:#e6db74>&#34;नमस्ते&#34;</span>.bytes() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>println!</span>(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span>, b);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This code will print the 18 bytes that make up this <code>String</code>:</p><pre tabindex=0><code>
224
164
// --snip--
165
135
</code></pre><p>But be sure to remember that valid Unicode scalar values may be made up of more than 1 byte.</p><p>Getting grapheme clusters from strings is complex, so this functionality is not provided by the standard library. Crates are available on <a href=https://crates.io/>crates.io</a> if this is the functionality you need.</p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white white-70 dn dib-ns pv2 ph3 no-underline" href=https://kuthorx.github.io/>&copy; KuthorX Blog II 2025</a><div><div class=ananke-socials></div></div></div></footer></body></html>